########################################################################
# Daemon configuration        
#
# This section is defining the behavior of rpimonitord. It define if
# embedded server should be started and its configuration.
#
########################################################################
# Define the delay between 2 kpi pooling (default:10)
# Note: If you want to change the default delay, the rrd file will have
# to be deleted rpimonitord will recreate them at next startup
#daemon.delay=10

# Define RRD database storage
# --> Idea: define here the RRD database configuration? 

# Define that rpimonitor shouldn't start web server (default:0)
#daemon.noserver=1

# Define the address used by the web server (default:0.0.0.0)
#daemon.addr=0.0.0.0

# Define port of the web server (default:8888)
daemon.port=8889

# Define user used to run the server process (default:pi)
# Note: If user is not existing, process will run with uid=1000
#daemon.user=pi

# Define group used to run the server process (default:pi)
# Note: If group is not existing, process will run with gid=1000
#daemon.group=pi

# Define the root directory of the web server (Default:./web)
#daemon.webroot=


########################################################################
# KPI extraction configuration 
#
# This part of the configuration file is defining which data to extract
# how to extract then and when.
#
# Static KPI are extracted once at rpimonitord startup.
# Dynamic KPI are extracted periodically (defined by daemon.delay)
#
# Each static KPI is defined by an id and with 4 parameters
# static.<static data id>.name=<data name>
# static.<static data id>.source=<data source>
# static.<static data id>.regexp=<data regexp>
# static.<static data id>.postprocess=<data postprocess>
#
# <static data id> is representing the id of the KPI
# <data name> is a string representing the KPI or the list of KPI 
#   separated by comma. Each name has to be unique.
#   Only alpha numerical charter and underscore are accepted.
# <data source> is a file or an executable file within the path. 
#   If the file exists, rpimonitord will read its content. If the file
#   is not existing, rpimonirotd will try to execute it and will parse 
#   the output. 
#   Warning: specifying an executable by its absolute name will tell
#   rpimonitord to read the content of the executable.1.graph.
# <data regexp> is the regular expression extracting information from
#   data source. Regexp groups () has to be used to extract the data
#   In case of KPI list, each group will be affected to a KPI name.
# <data postprocess> is an expression defining the postprocessing to 
#   be applied on result. KPI are idendified by $1. In case of list,
#   other KPI are identified by $2, $3 .graph..
#   This parameter will be evaluate by the command eval of perl. 
#
# Each dynamic KPI is defined by an id and with 5 parameters
# dynamic.<dynamic data id>.name=<data name>
# dynamic.<dynamic data id>.source=<data source>
# dynamic.<dynamic data id>.regexp=<data regexp>
# dynamic.<dynamic data id>.postprocess=<data postprocess>
# dynamic.<dynamic data id>.rrd=<|GAUGE|COUNTER|DERIVE|ABSOLUTE|COMPUTE>
#
# The 4 first parameters have the same signification as for static 
# parameters.
# The 5th parameter is defining if the KPI has to be stored into a RRD
# database and how. If ithe parameter is defined as empty, no RRD database
# will be created. If this parameter is defined, a RRD database will be
# created and data will be stored at every extraction. 
# Ref http://oss.oetiker.ch/rrdtool/doc/rrdcreate.en.html for RRD 
# parameter description.
#
########################################################################
static.1.name=distribution
static.1.source=/etc/os-release
static.1.regexp=PRETTY_NAME.\"(.*)\"
static.1.postprocess=

static.2.name=kernel_version
static.2.source=uname -msr
static.2.regexp=(.*)
static.2.postprocess=

static.3.name=processor
static.3.source=/proc/cpuinfo
static.3.regexp=Processor\s+: (.*)
static.3.postprocess=

static.4.name=scaling_governor
static.4.source=/sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
static.4.regexp=(.*)
static.4.postprocess=$1/1000

static.5.name=memory_total
static.5.source=/proc/meminfo
static.5.regexp=MemTotal:\s+(\d+)
static.5.postprocess=

static.6.name=swap_total
static.6.source=/proc/meminfo
static.6.regexp=SwapTotal:\s+(\d+)
static.6.postprocess=

static.7.name=sdcard_root_total
static.7.source=df -t ext4
static.7.regexp=root\s+(\d+)
static.7.postprocess=

static.8.name=sdcard_boot_total
static.8.source=df -t vfat
static.8.regexp=mmcblk0p1\s+(\d+)
static.8.postprocess=

##############################################################################
dynamic.1.name=upgrade
dynamic.1.source=/usr/share/rpimonitor/updatestatus.txt
dynamic.1.regexp=(\d+ upgraded, \d+ .*|.*&nbsp;.*)
dynamic.1.postprocess=
dynamic.1.rrd=

dynamic.2.name=packages
dynamic.2.source=/usr/share/rpimonitor/updatestatus.txt
dynamic.2.regexp=^  (.*)\d+ upgraded,
dynamic.2.postprocess=
dynamic.2.rrd=

dynamic.3.name=cpu_frequency
dynamic.3.source=/sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
dynamic.3.regexp=(.*)
dynamic.3.postprocess=
dynamic.3.rrd=

dynamic.4.name=voltage
dynamic.4.source=vcgencmd measure_volts core
dynamic.4.regexp=(\d+.\d+)V
dynamic.4.postprocess=
dynamic.4.rrd=

dynamic.5.name=load1,load5,load15
dynamic.5.source=/proc/loadavg
dynamic.5.regexp=^(\S+)\s(\S+)\s(\S+)
dynamic.5.postprocess=
dynamic.5.rrd=GAUGE

dynamic.6.name=sdcard_root_free
dynamic.6.source=df -t ext4
dynamic.6.regexp=root\s+\d+\s+\d+\s+(\d+)
dynamic.6.postprocess=
dynamic.6.rrd=GAUGE

dynamic.7.name=sdcard_boot_free
dynamic.7.source=df -t vfat
dynamic.7.regexp=mmcblk0p1\s+\d+\s+\d+\s+(\d+)
dynamic.7.postprocess=
dynamic.7.rrd=GAUGE

dynamic.8.name=swap_free
dynamic.8.source=/proc/meminfo
dynamic.8.regexp=SwapFree:\s+(\d+)
dynamic.8.postprocess=
dynamic.8.rrd=GAUGE

dynamic.9.name=memory_free
dynamic.9.source=/proc/meminfo
dynamic.9.regexp=MemFree:\s+(\d+)
dynamic.9.postprocess=
dynamic.9.rrd=GAUGE

dynamic.10.name=net_received
dynamic.10.source=/sys/class/net/eth0/statistics/rx_bytes
dynamic.10.regexp=(.*)
dynamic.10.postprocess=
dynamic.10.rrd=DERIVE

dynamic.11.name=net_send
dynamic.11.source=/sys/class/net/eth0/statistics/tx_bytes
dynamic.11.regexp=(.*)
dynamic.11.postprocess=
dynamic.11.rrd=DERIVE

dynamic.12.name=soc_temp
dynamic.12.source=/sys/devices/virtual/thermal/thermal_zone0/temp
dynamic.12.regexp=(.*)
dynamic.12.postprocess=$1/1000
dynamic.12.rrd=GAUGE

dynamic.13.name=uptime
dynamic.13.source=/proc/uptime
dynamic.13.regexp=^(\S+)
dynamic.13.postprocess=
dynamic.13.rrd=GAUGE

#dynamic.14.name=living room temperature
#dynamic.14.source=/sys/devices/w1_bus_master1/28-000004fe1847/w1_slave
#dynamic.14.regexp=t=(\d+)$
#dynamic.14.postprocess=
#dynamic.14.rrd=GAUGE


########################################################################
# Web interface configuration
#
# web.friends.<id>.name=<display name>
# web.friends.<id>.link=<link to RPi-Monitor>
#
# web.status.<page id>.name=<page name>
# web.status.<page id>.<status id>.name=<display name>
# web.status.<page id>.<status id>.icon=<display icon>
# web.status.<page id>.<status id>.data.<id>=<data name>
# web.status.<page id>.<status id>.line.<line number>.<function>=<parameter>
#
#   <functions> can be one of the following: 
#     text(text $1 text $2 $3)    -> text xxxx text xx xxx
#     clock(hh:mm:ss)             -> xx:xx:xx
#     usage(free,total)           -> Used: xxxXB (xx.x%) Free: xxxXB Total: xxxXB
#     progressbar(value,total)    -> [=========------------]
#     sendrecieved(send,received) -> Sent: xxxXB Recieved: xxxXB
#
# web.statistic.<page id>.name=<page name>
# web.statistic.<page id>.<statistic id>.name=<statistic name>
# web.statistic.<page id>.<statistic id>.rrd.<rrd id>=<data name>
#
#######################################################################

web.friends.1.name=Raspberry Pi
web.friends.1.link=http://192.168.0.123/
web.friends.2.name=Shuttle
web.friends.2.link=http://192.168.0.2/
web.friends.3.name=Laptop
web.friends.3.link=http://192.168.0.38/

#######################################################################
web.status.1.name=Raspberry Pi
web.status.1.1.name=Version
web.status.1.1.icon=version.png
web.status.1.1.data.1=processor 
web.status.1.1.data.2=distribution
web.status.1.1.data.3=kernel_version 
web.status.1.1.line.1.text=Processor: $1
web.status.1.1.line.2.text=Distribution: $2
web.status.1.1.line.3.text=Kernel version: $3

web.status.1.2.name=Uptime
web.status.1.2.icon=uptime.png
web.status.1.2.data.1=clock
web.status.1.2.data.2=uptime
web.status.1.2.line.1.text=Raspberry Pi time: 
web.status.1.2.line.1.clock=$1
web.status.1.2.line.2.duration=$2

web.status.1.3.name=CPU
web.status.1.3.icon=cpu.png
web.status.1.3.data.1=load1
web.status.1.3.data.2=load5
web.status.1.3.data.3=load15
web.status.1.3.data.4=cpu_frequency
web.status.1.3.data.5=cpu_voltage
web.status.1.3.data.6=scaling_governor
web.status.1.3.line.1.text=Loads: $1 [1min] - $2 [5min] - $3 [15min]
web.status.1.3.line.2.text=CPU frequency: $4 Voltage: $5
web.status.1.3.line.3.text=Scaling governor: $6

web.status.1.4.name=Temperature
web.status.1.4.icon=temperature.png
web.status.1.4.data.1=soc_temp
web.status.1.4.line.1.text=Temperature: $1 &deg;C

web.status.1.5.name=Memory
web.status.1.5.icon=memory.png
web.status.1.5.data.1=memory_free
web.status.1.5.data.2=memory_total
web.status.1.5.line.1.usage=$1 $2
web.status.1.5.line.2.progressbar=0 $3 $2

web.status.1.6.name=Swap
web.status.1.6.icon=swap.png
web.status.1.6.data.1=swap_free
web.status.1.6.data.2=swap_total
web.status.1.6.line.1.usage=$1 $2
web.status.1.6.line.2.progressbar=$1 $2

web.status.1.7.name=SD card
web.status.1.7.icon=sdcard.png
web.status.1.7.data.1=sdcard_boot_free
web.status.1.7.data.2=sdcard_boot_total
web.status.1.7.data.3=sdcard_root_free
web.status.1.7.data.4=sdcard_root_total
web.status.1.7.line.1.text=/boot
web.status.1.7.line.1.usage=$1 $2
web.status.1.7.line.2.progressbar=$1 $2 
web.status.1.7.line.3.text=/
web.status.1.7.line.3.usage=$3 $4
web.status.1.7.line.4.progressbar=$3 $4

web.status.1.8.name=Network
web.status.1.8.icon=network.png
web.status.1.8.data.1=net_send
web.status.1.8.data.2=net_received
web.status.1.8.line.1.text=Ethernet  
web.status.1.8.line.1.sendreceived=$1 $2

#######################################################################
web.statistic.1.name=Raspberry Pi
web.statistic.1.1.name=CPU loads
web.statistic.1.1.graph.1=load1
web.statistic.1.1.graph.2=load5
web.statistic.1.1.graph.3=load15

web.statistic.1.2.name=Network
web.statistic.1.2.graph.1=net_recived
web.statistic.1.2.graph.2=net_send

web.statistic.1.3.name=Disk
web.statistic.1.3.graph.1=sdcard_root_free
web.statistic.1.3.graph.2=sdcard_boot_free
web.statistic.1.3.graph.3=swap_free

web.statistic.1.4.name=Memory
web.statistic.1.4.graph.1=memory_free

web.statistic.1.5.name=Uptime
web.statistic.1.5.graph.1=uptime

web.statistic.1.6.name=Temperature
web.statistic.1.6.graph.1=temperature
