########################################################################
# Daemon configuration        
#
# This section is defining the behavior of rpimonitord. It define if
# embedded server should be started and its configuration.
#
########################################################################
# Define the delay between 2 kpi pooling (default:10)
# Note: If you want to change the default delay, the rrd file will have
# to be deleted rpimonitord will recreate them at next startup
#daemon.delay=10

# Define RRD database storage
# --> Idea: define here the RRD database configuration? 

# Define that rpimonitor shouldn't start web server (default:0)
#daemon.noserver=0

# Define the address used by the web server (default:0.0.0.0)
#server.addr=0.0.0.0

# Define port of the web server (default:8888)
#server.port=8888

# Define user used to run the server process (default:pi)
# Note: If user is not existing, process will run with uid=1000
#server.user=pi

# Define group used to run the server process (default:pi)
# Note: If group is not existing, process will run with gid=1000
#server.group=pi

# Define the root directory of the web server (Default:./web)
#server.webroot=


########################################################################
# KPI extraction configuration 
#
# This part of the configuration file is defining which data to extract
# how to extract then and when.
#
# Static KPI are extracted once at rpimonitord startup.
# Dynamic KPI are extracted periodically (defined by daemon.delay)
#
# Each static KPI is defined by an id and with 4 parameters
# static.data.<static data id>.name=<data name>
# static.data.<static data id>.source=<data source>
# static.data.<static data id>.regexp=<data regexp>
# static.data.<static data id>.postprocess=<data postprocess>
#
# <static data id> is representing the id of the KPI
# <data name> is a string representing the KPI or the list of KPI 
#   separated by comma. Each name has to be unique.
#   Only alpha numerical charter and underscore are accepted.
# <data source> is a file or an executable file within the path. 
#   If the file exists, rpimonitord will read its content. If the file
#   is not existing, rpimonirotd will try to execute it and will parse 
#   the output. 
#   Warning: specifying an executable by its absolute name will tell
#   rpimonitord to read the content of the executable...
# <data regexp> is the regular expression extracting information from
#   data source. Regexp groups () has to be used to extract the data
#   In case of KPI list, each group will be affected to a KPI name.
# <data postprocess> is an expression defining the postprocessing to 
#   be applied on result. KPI are idendified by $1. In case of list,
#   other KPI are identified by $2, $3 ...
#
# Each dynamic KPI is defined by an id and with 5 parameters
# dynamic.data.<dynamic data id>.name=<data name>
# dynamic.data.<dynamic data id>.source=<data source>
# dynamic.data.<dynamic data id>.regexp=<data regexp>
# dynamic.data.<dynamic data id>.postprocess=<data postprocess>
# dynamic.data.<dynamic data id>.rrd=<|GAUGE|COUNTER|DERIVE|ABSOLUTE|COMPUTE>
#
# The 4 first parameters have the same signification as for static 
# parameters.
# The 5th parameter is defining if the KPI has to be stored into a RRD
# database and how. If ithe parameter is defined as empty, no RRD database
# will be created. If this parameter is defined, a RRD database will be
# created and data will be stored at every extraction. 
# Ref http://oss.oetiker.ch/rrdtool/doc/rrdcreate.en.html for RRD 
# parameter description.
#
########################################################################
static.data.1.name=distribution
static.data.1.source=/etc/os-release
static.data.1.regexp=PRETTY_NAME.\"(.*)\"
static.data.1.postprocess=

static.data.2.name=kernel_version
static.data.2.source=uname -msr
static.data.2.regexp=(.*)
static.data.2.postprocess=

static.data.3.name=processor
static.data.3.source=/proc/cpuinfo
static.data.3.regexp=Processor\s+: (.*)
static.data.3.postprocess=

static.data.4.name=scaling_governor
static.data.4.source=/sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
static.data.4.regexp=(.*)
static.data.4.postprocess=

static.data.5.name=memory_total
static.data.5.source=/proc/meminfo
static.data.5.regexp=MemTotal:\s+(\d+)
static.data.5.postprocess=

static.data.6.name=swap_total
static.data.6.source=/proc/meminfo
static.data.6.regexp=SwapTotal:\s+(\d+)
static.data.6.postprocess=

static.data.7.name=sdcard_root_total
static.data.7.source=df -t ext4
static.data.7.regexp=root\s+(\d+)
static.data.7.postprocess=

static.data.8.name=sdcard_boot_total
static.data.8.source=df -t vfat
static.data.8.regexp=mmcblk0p1\s+(\d+)
static.data.8.postprocess=

##############################################################################
dynamic.data.1.name=upgrade
dynamic.data.1.source=/usr/share/rpimonitor/updatestatus.txt
dynamic.data.1.regexp=(\d+ upgraded, \d+ .*|.*&nbsp;.*)
dynamic.data.1.postprocess=
dynamic.data.1.rrd=0

dynamic.data.2.name=packages
dynamic.data.2.source=/usr/share/rpimonitor/updatestatus.txt
dynamic.data.2.regexp=^  (.*)\d+ upgraded,
dynamic.data.2.postprocess=
dynamic.data.2.rrd=0

dynamic.data.3.name=cpu_frequency
dynamic.data.3.source=/sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
dynamic.data.3.regexp=(.*)
dynamic.data.3.postprocess=
dynamic.data.3.rrd=

dynamic.data.4.name=voltage
dynamic.data.4.source=vcgencmd measure_volts core
dynamic.data.4.regexp=(\d+.\d+)V
dynamic.data.4.postprocess=
dynamic.data.4.rrd=0

dynamic.data.5.name=load1,load5,load15
dynamic.data.5.source=/proc/loadavg
dynamic.data.5.regexp=^(\S+)\s(\S+)\s(\S+)
dynamic.data.5.postprocess=
dynamic.data.5.rrd=1

dynamic.data.6.name=sdcard_root_free
dynamic.data.6.source=df -t ext4
dynamic.data.6.regexp=root\s+\d+\s+\d+\s+(\d+)
dynamic.data.6.postprocess=
dynamic.data.6.rrd=1

dynamic.data.7.name=sdcard_boot_free
dynamic.data.7.source=df -t vfat
dynamic.data.7.regexp=mmcblk0p1\s+\d+\s+\d+\s+(\d+)
dynamic.data.7.postprocess=
dynamic.data.7.rrd=1

dynamic.data.8.name=swap_free
dynamic.data.8.source=/proc/meminfo
dynamic.data.8.regexp=SwapFree:\s+(\d+)
dynamic.data.8.postprocess=
dynamic.data.8.rrd=1

dynamic.data.9.name=memory_free
dynamic.data.9.source=/proc/meminfo
dynamic.data.9.regexp=MemFree:\s+(\d+)
dynamic.data.9.postprocess=
dynamic.data.9.rrd=1

dynamic.data.10.name=net_received
dynamic.data.10.source=/sys/class/net/eth0/statistics/rx_bytes
dynamic.data.10.regexp=(.*)
dynamic.data.10.postprocess=
dynamic.data.10.rrd=DERIVE

dynamic.data.11.name=net_send
dynamic.data.11.source=/sys/class/net/eth0/statistics/tx_bytes
dynamic.data.11.regexp=(.*)
dynamic.data.11.postprocess=
dynamic.data.11.rrd=DERIVE

dynamic.data.12.name=soc_temp
dynamic.data.12.source=/sys/devices/virtual/thermal/thermal_zone0/temp
dynamic.data.12.regexp=(.*)
dynamic.data.12.postprocess=$1/1000
dynamic.data.12.rrd=1

dynamic.data.13.name=uptime
dynamic.data.13.source=/proc/uptime
dynamic.data.13.regexp=^(\S+)
dynamic.data.13.postprocess=
dynamic.data.13.rrd=1

########################################################################
# Web interface configuration
#
# web.friends.<id>.name=<display name>
# web.friends.<id>.link=<link to RPi-Monitor>
#
# web.status..<status id>.name=<display name>
# web.status..<status id>.icon=<display icon>
# web.status..<status id>.data.<id>=<data name>
# web.status..<status id>.line.<line number>.<function>=<parameter>
#
#   <functions> can be one of the following: 
#     text(text $1 text $2 $3)    -> text xxxx text xx xxx
#     clock(hh:mm:ss)             -> xx:xx:xx
#     usage(free,total)           -> Used: xxxXB (xx.x%) Free: xxxXB Total: xxxXB
#     progressbar(value,total)    -> [=========------------]
#     sendrecieved(send,received) -> Sent: xxxXB Recieved: xxxXB
#
# web.statistic.<sub menu>.<statistic id>.name=<statistic name>
# web.statistic.<sub menu>.<statistic id>.rrd.<rrd id>=<data name>
#
#######################################################################

web.friends.1.name=Raspberry Pi
web.friends.1.link=http://192.168.0.123/
web.friends.2.name=Shuttle
web.friends.2.link=http://192.168.0.2/
web.friends.3.name=Laptop
web.friends.3.link=http://192.168.0.38/

#######################################################################
web.status..1.name=Version
web.status..1.icon=version.png
web.status..1.data.1=processor 
web.status..1.data.2=distribution
web.status..1.data.3=kernel_version 
web.status..1.line.1.text=Processor: $1
web.status..1.line.2.text=Distribution: $2
web.status..1.line.3.text=Kernel version: $3

web.status..2.name=Uptime
web.status..2.icon=uptime.png
web.status..2.data.1=clock
web.status..2.data.2=uptime
web.status..2.line.1.text=Raspberry Pi time: 
web.status..2.line.1.clock=$1
web.status..2.line.2.duration=$2

web.status..3.name=CPU
web.status..3.icon=cpu.png
web.status..3.data.1=load1
web.status..3.data.2=load5
web.status..3.data.3=load15
web.status..3.data.4=cpu_frequency
web.status..3.data.5=cpu_voltage
web.status..3.data.6=scaling_governor
web.status..3.line.1.text=Loads: $1 [1min] - $2 [5min] - $3 [15min]
web.status..3.line.2.text=CPU frequency: $4 Voltage: $5
web.status..3.line.3.text=Scaling governor: $6

web.status..4.name=Temperature
web.status..4.icon=temperature.png
web.status..4.data.1=soc_temp
web.status..4.line.1.text=Temperature: $1

web.status..5.name=Memory
web.status..5.icon=memory.png
web.status..5.data.1=memory_free
web.status..5.data.2=memory_total
web.status..5.line.1.usage=$1 $2
web.status..5.line.2.progressbar=0 $3 $2

web.status..6.name=Swap
web.status..6.icon=swap.png
web.status..6.data.1=swap_free
web.status..6.data.2=swap_total
web.status..6.line.1.usage=$1 $2
web.status..6.line.2.progressbar=$1 $2

web.status..7.name=SD card
web.status..7.icon=sdcard.png
web.status..7.data.1=sdcard_boot_free
web.status..7.data.2=sdcard_boot_total
web.status..7.data.3=sdcard_root_free
web.status..7.data.4=sdcard_root_total
web.status..7.line.1.text=/boot
web.status..7.line.1.usage=$1 $2
web.status..7.line.2.progressbar=$1 $2 
web.status..7.line.3.text=/
web.status..7.line.3.usage=$3 $4
web.status..7.line.4.progressbar=$3 $4

web.status..8.name=Network
web.status..8.icon=network.png
web.status..8.data.1=net_send
web.status..8.data.2=net_received
web.status..8.line.1.text=Ethernet  
web.status..8.line.1.sendreceived=$1 $2

#######################################################################
web.statistic..1.name=CPU loads
web.statistic..1.rrd.1=load1
web.statistic..1.rrd.2=load5
web.statistic..1.rrd.3=load15

web.statistic..2.name=Network
web.statistic..2.rrd.1=net_recived
web.statistic..2.rrd.2=net_send

web.statistic..3.name=Disk
web.statistic..3.rrd.1=sdcard_root_free
web.statistic..3.rrd.2=sdcard_boot_free
web.statistic..3.rrd.3=swap_free

web.statistic..4.name=Memory
web.statistic..4.rrd.1=memory_free

web.statistic..5.name=Uptime
web.statistic..5.rrd.1=uptime

web.statistic..6.name=Temperature
web.statistic..6.rrd.1=temperature
